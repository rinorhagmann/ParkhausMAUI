<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodel="clr-namespace:ParkhausMAUI.ViewModels"
             x:Class="ParkhausMAUI.Views.ActiveParkingPage"
             x:DataType="viewmodel:ActiveParkingViewModel"
             Title="Aktueller Parkvorgang">

    <VerticalStackLayout Spacing="25" Padding="30" VerticalOptions="Center">

        <VerticalStackLayout IsVisible="{Binding IsParkingActive}" Spacing="15">
            <Label Text="Sie parken aktuell im:" HorizontalOptions="Center" TextColor="Gray"/>
            <Label Text="{Binding CurrentSession.ParkhausName}" 
                   FontSize="24" FontAttributes="Bold" HorizontalOptions="Center" Margin="0,0,0,10"/>

            <Frame BackgroundColor="#F0F0F0" CornerRadius="100" WidthRequest="200" HeightRequest="200" HorizontalOptions="Center" HasShadow="False">
                <VerticalStackLayout VerticalOptions="Center">
                    <Label Text="{Binding ElapsedTime}" FontSize="32" FontAttributes="Bold" HorizontalOptions="Center"/>
                    <Label Text="Dauer" HorizontalOptions="Center" FontSize="12"/>
                </VerticalStackLayout>
            </Frame>

            <Label Text="{Binding CurrentCosts}" FontSize="40" TextColor="{StaticResource Primary}" 
                   FontAttributes="Bold" HorizontalOptions="Center" Margin="0,10"/>

            <VerticalStackLayout Spacing="10" Margin="0,20,0,0">

                <Button Text="Bezahlen" 
                        Command="{Binding PayParkingCommand}" 
                        IsVisible="{Binding IsNotPaid}"
                        BackgroundColor="{StaticResource Primary}" 
                        TextColor="White"
                        CornerRadius="20" 
                        HeightRequest="50"/>

                <Button Text="Parken beenden" 
                        Command="{Binding StopParkingCommand}" 
                        IsVisible="{Binding IsPaid}"
                        BackgroundColor="Green" 
                        TextColor="White"
                        CornerRadius="20" 
                        HeightRequest="50"/>

                <Label Text="✓ Bezahlt" 
                       TextColor="Green" 
                       HorizontalOptions="Center" 
                       FontAttributes="Bold"
                       IsVisible="{Binding IsPaid}"/>
            </VerticalStackLayout>
        </VerticalStackLayout>

        <VerticalStackLayout IsVisible="{Binding IsNotParkingActive}" Spacing="20">
            <Label Text="ℹ️" FontSize="60" HorizontalOptions="Center"/>
            <Label Text="Aktuell ist kein Parkvorgang aktiv." HorizontalOptions="Center" FontSize="18"/>
            <Button Text="Jetzt Parkhaus wählen" 
                    Clicked="GoToMainPage" 
                    HorizontalOptions="Center"
                    BackgroundColor="{StaticResource Primary}"/>
        </VerticalStackLayout>

    </VerticalStackLayout>
</ContentPage>